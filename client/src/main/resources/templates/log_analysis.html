<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deception Log Insights</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@1.2.1"></script>
    <link rel="stylesheet" type="text/css" href="/css/common.css">
    <link rel="stylesheet" type="text/css" href="/css/log_analysis.css">
    <script src="/js/log_analysis.js"></script>
</head>
<body>
<div class="container">

    <div class="title">
        <h1><span>Deception Component Generator</span></h1>
        <h3>Log Insights Dashboard</h3>
    </div>

    <p>This page provides an in-depth analysis of the logs generated by the deception components. The dashboard offers insights into attack patterns, targeted endpoints, suspicious IP addresses, and temporal patterns of the log data.</p>

    <div class="dashboard-section">
        <h2>Overview</h2>
        <div class="overview-metrics">
            <div class="metric">
                <h3>Total Logs</h3>
                <p id="totalLogs">0</p>
            </div>
            <div class="metric">
                <h3>Unique IPs</h3>
                <p id="uniqueIPs">0</p>
            </div>
            <div class="metric">
                <h3>Targeted Endpoints</h3>
                <p id="targetedEndpoints">0</p>
            </div>
        </div>
    </div>

    <div class="dashboard-section">
        <h2>Attack Patterns</h2>
        <canvas id="attackPatternsChart"></canvas>
    </div>

    <div class="dashboard-section">
        <h2>Targeted Endpoints</h2>
        <label for="limitendpoints">Limit: </label><input type="number" name="limitendpoints" id="limitendpoints" value="10" onchange="updateTargetedEndpoints(this.value)">
        <canvas id="targetedEndpointsChart"></canvas>
    </div>

    <div class="dashboard-section">
        <h2>JWT Token Attempts</h2>
        <div id="jwtTokenAttempts"></div>
    </div>

    <div class="dashboard-section">
        <h2>XSS Attempts</h2>
        <div id="xssAttempts"></div>
    </div>

    <div class="dashboard-section">
        <h2>Command Executions</h2>
        <div id="commandExecutions"></div>
    </div>

    <div class="dashboard-section">
        <h2>Invalid Admin Page Access Attempts</h2>
        <label for="limitAdminPageAccessAttempts">Limit: </label><input type="number" name="limitAdminPageAccessAttempts" id="limitAdminPageAccessAttempts" value="10" onchange="updateInvalidAdminPageAccessAttempts(this.value)">
        <div id="invalidAdminPageAccessAttempts"></div>
    </div>

    <div class="dashboard-section">
        <h2>Suspicious IP Addresses (Top 10)</h2>
        <label for="limitsuspiciousips">Limit: </label><input type="number" name="limitsuspiciousips" id="limitsuspiciousips" value="10" onchange="updateSuspiciousIPs(this.value)">
        <div id="suspiciousIPsList"></div>
    </div>

    <div class="dashboard-section">
        <h2>Temporal Patterns</h2>
        <label for="temporalGroupBy"></label><select id="temporalGroupBy">
            <option value="hour">Hour</option>
            <option value="day">Day</option>
        </select>

        <canvas id="temporalPatternsChart"></canvas>
    </div>

    <div class="dashboard-section">
        <h2>HTTP Headers Analysis</h2>
        <h3>User-Agent Analysis</h3>
        <label for="limitHTTPHeadersUA">Limit: </label><input type="number" name="limitHTTPHeadersUA" id="limitHTTPHeadersUA" value="10" onchange="updateHTTPHeadersAnalysisUA(this.value)">
        <div id="httpHeadersAnalysisUA"></div>

        <h3>Authorization Analysis</h3>
        <label for="limitHTTPHeadersAuth">Limit: </label><input type="number" name="limitHTTPHeadersAuth" id="limitHTTPHeadersAuth" value="10" onchange="updateHTTPHeadersAnalysisAuth(this.value)">
        <div id="httpHeadersAnalysisAuth"></div>
    </div>

    <div class="dashboard-section">
        <h2>Geo-Location of Requests</h2>
        <div id="geoLocationRequests"></div>
    </div>

    <div class="dashboard-section">
        <h2>Client Session Analysis</h2>
        <label for="limitsessions">Limit: </label><input type="number" name="limitsessions" id="limitsessions" value="10" onchange="updateSessions(this.value)">

        <div id="clientBehaviorAnalysis"></div>
    </div>

    <div class="buttons">
        <button id="backButton">Back</button>
        <button id="downloadPDFButton">Download PDF</button>
    </div>

    <div id="footer">
        <section>
            <div><span>Username: </span><span id="username" class="username" th:text="${username}"></span></div>
            <form th:action="@{/}" method="get">
                <input type="submit" value="Home"/>
            </form>
        </section>
    </div>
</div>
</body>
</html>
