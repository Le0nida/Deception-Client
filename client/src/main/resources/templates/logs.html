<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Log Filter</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script th:src="@{/js/logs.js}"></script>
    <link rel="stylesheet" type="text/css" href="/css/common.css">
    <link rel="stylesheet" type="text/css" href="/css/logs.css">
</head>
<body>
<div class="container">

    <div class="title">
        <h1><span>Deception Component Generator</span></h1>
        <h3>Log Filter</h3>
    </div>

    <p>
        Use the underlying <i>form</i> to create a filter to retrieve logs related to your server. It is mandatory to include the <b>URL</b> where the server is reachable and the <b>token</b> provided during generation.
    </p>

    <div class="button-container">
        <button id="reset">Reset</button>
        <button id="getlogs">Get Logs</button>
        <button class="disabled-btn" id="downloadLogs" disabled>Download Logs</button>
        <button class="disabled-btn" id="getInsights" disabled>Get Insights</button>
    </div>



    <div id="httpRequestLogForm">

        <div class="form-container">

            <div class="form-section">
                <h2>Server Specific Fields</h2>
                <p>These fields pertain to a single server generated by the Deception Component Generator service.</p>
                <label for="urlInput">URL:</label><input type="url" id="urlInput" value="http://localhost:8080">
                <label for="tokenInput">Token:</label><input type="text" id="tokenInput">
            </div>

            <div class="form-section">
                <h2>Date From Filter</h2>
                <p>This date represents the moment from which to retrieve logging up to now.</p>
                <p><b>WARNING:</b> if a filter is set on the time, it is mandatory to also define the filter for the date.</p>
                <label for="date">Date:</label>
                <input type="date" id="date" name="date"><br><br>

                <label for="time">Time:</label>
                <input type="time" id="time" name="time"><br><br>
            </div>

            <div class="form-section">
                <h2>Header fields</h2>
                <p>These fields represent the HTTP request header. They are equality filters.</p>

                <label for="headers_host">Host:</label>
                <input type="text" id="headers_host" name="headers_host" placeholder="e.g., www.example.com"><br><br>

                <label for="headers_useragent">User Agent:</label>
                <input type="text" id="headers_useragent" name="headers_useragent" placeholder="e.g., Mozilla/5.0"><br><br>

                <label for="headers_contenttype">Content Type:</label>
                <input type="text" id="headers_contenttype" name="headers_contenttype" placeholder="e.g., application/json"><br><br>

                <label for="headers_acccept">Accept:</label>
                <input type="text" id="headers_acccept" name="headers_acccept" placeholder="e.g., text/html"><br><br>

                <label for="headers_authorization">Authorization:</label>
                <input type="text" id="headers_authorization" name="headers_authorization" placeholder="e.g., Bearer token123"><br><br>
            </div>
        </div>

        <div class="form-container">
            <div class="form-section">
                <h2>Exact Match Filters</h2>
                <p>Each of these fields checks for exact equality.</p>
                <label for="httpMethod">HTTP Method:</label>
                <input type="text" id="httpMethod" name="httpMethod" placeholder="e.g., GET"><br><br>

                <label for="requestURL">Request URL:</label>
                <input type="text" id="requestURL" name="requestURL" placeholder="e.g., /api/user/login"><br><br>

                <label for="clientIPAddress">Client IP Address:</label>
                <input type="text" id="clientIPAddress" name="clientIPAddress" placeholder="e.g., 192.168.0.1"><br><br>

                <label for="clientPort">Client Port:</label>
                <input type="number" id="clientPort" name="clientPort" placeholder="e.g., 8080"><br><br>

                <label for="protocol">Protocol:</label>
                <input type="text" id="protocol" name="protocol" placeholder="e.g., HTTP/1.1"><br><br>
            </div>

            <div class="form-section">
                <h2>String Containment Filters</h2>
                <p>Each of these fields checks that its value is contained within the field of the element being filtered.</p>
                <label for="queryParameters">Query Parameters:</label>
                <input type="text" id="queryParameters" name="queryParameters" placeholder="e.g., param1=value1&param2=value2"><br><br>

                <label for="requestBody">Request Body:</label>
                <input type="text" id="requestBody" name="requestBody" placeholder="e.g., {'key':'value'}"><br><br>

                <label for="authenticationType">Authentication Type:</label>
                <input type="text" id="authenticationType" name="authenticationType" placeholder="e.g., Basic"><br><br>

                <label for="acceptedContentTypes">Accepted Content Types:</label>
                <input type="text" id="acceptedContentTypes" name="acceptedContentTypes" placeholder="e.g., application/json"><br><br>

                <label for="preferredLanguage">Preferred Language:</label>
                <input type="text" id="preferredLanguage" name="preferredLanguage" placeholder="e.g., en-US"><br><br>

                <label for="acceptedCompressionTypes">Accepted Compression Types:</label>
                <input type="text" id="acceptedCompressionTypes" name="acceptedCompressionTypes" placeholder="e.g., gzip"><br><br>

                <label for="acceptedConnectionTypes">Accepted Connection Types:</label>
                <input type="text" id="acceptedConnectionTypes" name="acceptedConnectionTypes" placeholder="e.g., keep-alive"><br><br>

                <label for="cookies">Cookies:</label>
                <input type="text" id="cookies" name="cookies" placeholder="e.g., cookie1=value1"><br><br>
            </div>
        </div>
    </div>

    <div id="footer">
        <section>
            <div><span>Username: </span><span id="username" class="username" th:text="${username}"></span></div>
            <form th:action="@{/}" method="get">
                <input type="submit" value="Home"/>
            </form>
        </section>
    </div>
</div>
</body>
</html>
